"0","p1 <- ggplot(recFinal) +"
"0","  geom_line(aes(year, Qbc, color = 'Annual')) +"
"0","  labs(x = NULL, y = 'P [mm]') +"
"0","  geom_line(aes(year, rolMax, colour = '50-yr max'), na.rm = TRUE, size = 0.4) +"
"0","  geom_line(aes(year, rolMin, colour = '50-yr min'), na.rm = TRUE, size = 0.4) +"
"0","  geom_line(aes(year, rolMed, colour = '50-yr median'), na.rm = TRUE, size = 0.4) +"
"0","  geom_smooth(aes(year, rolMax, colour = '50-yr max'), size = 0.6,"
"0","              formula = 'y ~ x', method = 'lm', na.rm = TRUE, fill = NA) +"
"0","  geom_smooth(aes(year, rolMin, colour = '50-yr min'), size = 0.6,"
"0","              formula = 'y ~ x', method = 'lm', na.rm = TRUE, fill = NA) +"
"0","  geom_smooth(aes(year, rolMed, colour = '50-yr median'), size= 0.6,"
"0","              formula = 'y ~ x', method = 'lm', na.rm = TRUE, fill = NA) +"
"0","  scale_x_continuous("
"0","    expand = c(0, 0),"
"0","    minor_breaks = seq(1500, 2025, 25),"
"0","    limits = c(1500, 2025),"
"0","    guide = guide_prism_offset_minor()) +"
"0","  scale_y_continuous("
"0","    minor_breaks = seq(200, 900, 50),"
"0","    breaks = seq(200, 900, 100),"
"0","    limits = c(200, 900),"
"0","    labels = skip_label(2),"
"0","    guide = guide_prism_offset_minor()) +"
"0","  labs(x = NULL, y = 'Precipitation [mm]', colour = NULL, tag = 'a)') +"
"0","  scale_color_manual(values = c(RColorBrewer::brewer.pal(3, 'Set2'), 'gray')) +"
"0","  theme("
"0","    legend.key.width = unit(0.5, 'cm'),"
"0","    legend.position = 'top')"
"0",""
"0","p2 <- ggplot(densCals) +"
"0","  geom_ribbon(aes(x, ymin = period, ymax = y + period, group = factor(period),"
"0","                  fill = factor(period)), "
"0","              alpha = 0.5) +"
"0","  geom_line(aes(x, y + period, group = factor(period))) +"
"0","  geom_linerange(aes(x, ymin = period, ymax = period + y), medians, colour = 'firebrick') +"
"0","  scale_fill_manual("
"0","    labels = c('1517-1717', '1718-2018'),"
"0","    values = wesanderson::wes_palette('Royal1', 4)[c(1, 4)]) +"
"0","  scale_x_continuous("
"0","    guide = guide_prism_offset_minor(),"
"0","    breaks = seq(200, 900, 100), "
"0","    minor_breaks = seq(200, 900, 20)) +"
"0","  scale_y_continuous("
"0","    expand = c(0, 0),"
"0","    breaks = c(1.5, 2.5),"
"0","    labels = c('1517-1717', '            1718-2018')) +"
"0","  labs(x = 'Precipitation [mm]', y = NULL, tag = 'b)') +"
"0","  theme("
"0","    legend.position = 'none',"
"0","    axis.line.y = element_blank(),"
"0","    axis.text.y.left = element_text(angle = 90, hjust = 0.5),"
"0","    axis.ticks.y = element_blank())"
"0",""
"0","p3 <- ggplot(recFinal) +"
"0","  geom_rect("
"0","    aes(xmin = yearStart, xmax = yearFinal, ymin = -Inf, ymax = Inf),"
"0","    worstDroughts,"
"0","    fill = 'magenta4', alpha = 0.1) +"
"0","  geom_col(aes(year, dP, fill = dP)) +"
"0","  scale_fill_distiller("
"0","    palette = 'BrBG', limits = abs_range(recFinal$dP),"
"0","    guide = guide_none(),"
"0","    direction = 1) +"
"0","  scale_color_manual(values = 'black') +"
"0","  scale_x_continuous("
"0","    expand = c(0, 0),"
"0","    minor_breaks = seq(1500, 2025, 25),"
"0","    limits = c(1500, 2025),"
"0","    guide = guide_prism_offset_minor()) +"
"0","  scale_y_continuous("
"0","    breaks = seq(-300, 400, 100),"
"0","    minor_breaks = seq(-300, 400, 50),"
"0","    guide = guide_prism_offset_minor()) +"
"0","  labs(x = NULL, y = 'Precipitation anomaly [mm]', tag = 'c)') +"
"0","  theme("
"0","    legend.position = 'top')"
"0",""
"0","p4 <- ggplot(droughts) +"
"0","  geom_point(aes(dur, peak, color = as.character(period)), alpha = 0.6) +"
"0","  geom_text("
"0","    aes(dur, peak, label = paste(yearStart, yearFinal, sep = '-')), "
"0","    worstDroughts,"
"0","    size = 2, hjust = 0.8, nudge_y = -15) +"
"0","  # scale_x_continuous("
"0","  #   breaks = seq(2, 20, 2),"
"0","  #   guide = guide_prism_offset_minor()) +"
"0","  # scale_y_continuous("
"0","  #   breaks = seq(-300, 0, 50),"
"0","  #   limits = c(-275, -25),"
"0","  #   guide = guide_prism_offset_minor()) +"
"0","  scale_color_manual("
"0","    labels = c('1517-1717', '1718-2018'),"
"0","    values = wesanderson::wes_palette('Royal1', 4)[c(1, 4)]) +"
"0","  labs(x = 'Drought duration [years]', y = 'Drought severity [mm]', tag = 'd)') +"
"0","  theme(legend.position = 'top')"
"0",""
"0","p1 + p2 + p3 + p4 +"
"0","  plot_layout(widths = c(1.5, 1))"
