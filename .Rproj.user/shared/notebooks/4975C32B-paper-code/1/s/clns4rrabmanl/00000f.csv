"0","X <- crnWide[, -'year'] |> "
"0","  as.matrix() |> "
"0","  imputePCA(ncp = 6) |> "
"0","  {\(x) x$completeObs}() "
"0","PC <- prcomp(X, scale. = TRUE)$x"
"0","Xraw <- as.matrix(crnWide[, -'year'])"
"0","impModel <- imputePCA(Xraw, ncp = 6)"
"0","Xfilled <- impModel$completeObs"
"0","Xfitted <- impModel$fittedX"
"0","colnames(Xfitted) <- colnames(Xfilled)"
"0",""
"0","crnFitted <- as.data.table(as.data.frame(Xfitted))"
"0","crnFitted[, year := 1517:2018]"
"0","crnFittedLong <- melt("
"0","  crnFitted, id.vars = 'year', variable.name = 'site', value.name = 'rwi')"
"0","crnMerge <- rbindlist("
"0","  list(Infilled = crnFittedLong, Original = crn[, .(site, year, rwi = res)]),"
"0","  use.names = TRUE,"
"0","  idcol = 'type')"
